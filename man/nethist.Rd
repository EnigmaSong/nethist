% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nethist.R
\name{nethist}
\alias{nethist}
\title{Network histogram estimation}
\usage{
nethist(A, h = NA, outfile, verbose = FALSE)
}
\arguments{
\item{A}{An adjacency matrix or igraph object. It must be an undirected and simple graph.}

\item{h}{A bandwidth parameter. If \code{NA}, selecting bandwidth by Olhede and Wolfe (2014). If specified, the user input value is used.}

\item{outfile}{A filename for saving cluster indices. If it is missing, the results are not saved in a file.}

\item{verbose}{logical value indicating whether verbose output is generated.}
}
\value{
An object of class \code{nethist}:

\itemize{
\item \code{cluster} a vector of partition indices.
\item \code{p_mat} a probability matrix from network histogram ordered by cluster labels.
\item \code{rho_hat} estimated sparsity parameter.
}
}
\description{
Estimating network histogram and returning the indices of partitions.
}
\details{
Note that \code{cluster} only shows a partition of vertices, and the index labels is not an ordered variable. For example, nodes in cluster 1 do not have to more similar to nodes in cluster 2 than nodes in cluster 10. Hence, users would use a user-specified order in \code{\link[=plot.nethist]{plot.nethist()}}.

\code{nethist()} runs the following two steps:
\itemize{
\item Initialization: With spectral clustering, find an initial partitions of vertices. If bandwidth \code{h} is not specified, automatic bandwidth selection is used.
\item Using a greedy search algorithm, find a (local) optima of normalized profile log-likelihood, which is \code{cluster} in the \code{nethist} object.
}
}
\examples{
\dontrun{
set.seed(2022)
#Generating Erdos-Renyi graph
A <- igraph::sample_gnp(100, 0.05)

#With automatic bandwidth selection
hist_A <- nethist(A) 

#with user-specified bandwidth
hist_A <- nethist(A, h = 20) 

#with adjancency matrix
hist_A <- nethist(igraph::as_adj(A)) 
}
}
\references{
Olhede, S. C., & Wolfe, P. J. (2014). Network histograms and universality of blockmodel approximation. Proceedings of the National Academy of Sciences, 111(41), 14722-14727.

Wolfe, P. J., & Olhede, S. C. (2013). Nonparametric graphon estimation. arXiv preprint arXiv:1309.5936.
}
\seealso{
\code{\link[=plot.nethist]{plot.nethist()}}
}
